<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>数据科学入门</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles1.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos218068" class="calibre_"><span class="calibre6"><span class="bold"> 6.6　正态分布 </span></span></p><p class="calibre_">正态分布是分布之王！它是典型的钟型曲线形态分布函数，可以完全由两个参数决定：均值 <span class="italic">μ</span> （mu）和标准差 <span class="italic">σ</span> （sigma）。均值描述钟型曲线的中心，标准差描述曲线有多“宽”。</p><p class="calibre_">正态分布的分布函数如下：</p><p class="calibre_12"><img src="images/00139.jpg" class="calibre_56"/>
</p><p class="calibre_">我们可以这样实现：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def normal_pdf(x, mu=0, sigma=1):<br class="calibre12"/>    sqrt_two_pi = math.sqrt(2 * math.pi)<br class="calibre12"/>    return (math.exp(-(x-mu) ** 2 / 2 / sigma ** 2) / (sqrt_two_pi * sigma))<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">在图 6-2 中我们绘出了这些概率密度函数，来看看它们的形状如何：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>xs = [x / 10.0 for x in range(-50, 50)]<br class="calibre12"/>plt.plot(xs,[normal_pdf(x,sigma=1) for x in xs],'-',label='mu=0,sigma=1')<br class="calibre12"/>plt.plot(xs,[normal_pdf(x,sigma=2) for x in xs],'--',label='mu=0,sigma=2')<br class="calibre12"/>plt.plot(xs,[normal_pdf(x,sigma=0.5) for x in xs],':',label='mu=0,sigma=0.5')<br class="calibre12"/>plt.plot(xs,[normal_pdf(x,mu=-1)   for x in xs],'-.',label='mu=-1,sigma=1')<br class="calibre12"/>plt.legend()<br class="calibre12"/>plt.title("多个正态分布的概率密度函数")<br class="calibre12"/>plt.show()<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_19"><img src="images/00039.jpg" class="calibre_57"/>
</p><p class="calibre_">
<span class="bold">图 6-2：多个正态分布的概率密度函数</span>
</p><p class="calibre_">如果 <span class="italic">μ</span> =0 并且 <span class="italic">σ</span> =1，这个分布称为标准正态分布。如果 <span class="italic">Z</span> 是服从标准正态分布的随机变量，则有如下转换式：</p><p class="calibre_12"><img src="images/00099.jpg" class="calibre_58"/>
</p><p class="calibre_">其中 <span class="italic">X</span> 也是正态分布，但均值是 <span class="italic">μ</span> ，标准差是 <span class="italic">σ</span> 。相反，如果 <span class="italic">X</span> 是均值为 <span class="italic">μ</span> 标准差为 <span class="italic">σ</span> 的正态分布，那么：</p><p class="calibre_12"><img src="images/00041.jpg" class="calibre_59"/>
</p><p class="calibre_">是标准正态分布的随机变量。</p><p class="calibre_">标准正态分布的累积分布函数无法用“基本”的解析形式表示，但在 Python 中可以用函数 <tt class="calibre7">math.erf</tt> 描述：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def normal_cdf(x, mu=0,sigma=1):<br class="calibre12"/>    return (1 + math.erf((x - mu) / math.sqrt(2) / sigma)) / 2<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">我们再绘出一系列概率累积分布函数（如图 6-3）：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>xs = [x / 10.0 for x in range(-50, 50)]<br class="calibre12"/>plt.plot(xs,[normal_cdf(x,sigma=1) for x in xs],'-',label='mu=0,sigma=1')<br class="calibre12"/>plt.plot(xs,[normal_cdf(x,sigma=2) for x in xs],'--',label='mu=0,sigma=2')<br class="calibre12"/>plt.plot(xs,[normal_cdf(x,sigma=0.5) for x in xs],':',label='mu=0,sigma=0.5')<br class="calibre12"/>plt.plot(xs,[normal_cdf(x,mu=-1) for x in xs],'-.',label='mu=-1,sigma=1')<br class="calibre12"/>plt.legend(loc=4) # 底部右边<br class="calibre12"/>plt.title("多个正态分布的累积分布函数")<br class="calibre12"/>plt.show()<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_19"><img src="images/00049.jpg" class="calibre_60"/>
</p><p class="calibre_">
<span class="bold">图 6-3：多个正态分布的累积分布函数</span>
</p><p class="calibre_">我们有时会需要对 <tt class="calibre7">normal_cdf</tt> 取逆，从而可以求出特定的概率的相应值。不存在计算逆函数的简便方法，但由于 <tt class="calibre7">normal_cdf</tt> 连续且严格递增，因而我们可以使用二分查找（<a href="https://en.wikipedia.org/wiki/Binary_search_algorithm" class="calibre3">https://en.wikipedia.org/wiki/Binary_search_algorithm</a> ）的方法：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def inverse_normal_cdf(p, mu=0, sigma=1, tolerance=0.00001):<br class="calibre12"/>    """find approximate inverse using binary search"""<br class="calibre12"/>    # 如果非标准型，先调整单位使之服从标准型<br class="calibre12"/>    if mu != 0 or sigma != 1:<br class="calibre12"/>        return mu + sigma * inverse_normal_cdf(p, tolerance=tolerance)<br class="calibre12"/><br class="calibre12"/>    low_z, low_p = -10.0, 0            # normal_cdf(-10)是（非常接近）0<br class="calibre12"/>    hi_z,  hi_p  = 10.0, 1             # normal_cdf(10)是（非常接近）1<br class="calibre12"/>    while hi_z - low_z &gt; tolerance:<br class="calibre12"/>        mid_z = (low_z + hi_z) / 2     # 考虑中点<br class="calibre12"/>        mid_p = normal_cdf(mid_z)      # 和cdf在那里的值<br class="calibre12"/>        if mid_p &lt; p:<br class="calibre12"/>            # midpoint仍然太低，搜索比它大的值<br class="calibre12"/>            low_z, low_p = mid_z, mid_p<br class="calibre12"/>        elif mid_p &gt; p:<br class="calibre12"/>            # midpoint仍然太高，搜索比它小的值<br class="calibre12"/>            hi_z, hi_p = mid_z, mid_p<br class="calibre12"/>        else:<br class="calibre12"/>            break<br class="calibre12"/><br class="calibre12"/>    return mid_z<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">这个函数反复分割区间，直到分割到一个足够接近于期望概率的精细的 <span class="italic">Z</span> 值。</p><div class="mbp_pagebreak" id="calibre_pb_44"></div>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre3">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre3">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
