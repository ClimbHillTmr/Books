<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>数据科学入门</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles1.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos579255" class="calibre_"><span class="calibre6"><span class="bold"> 19.5　示例：对色彩进行聚类 </span></span></p><p class="calibre_">负责周边产品的副总设计了一款美观的 DataSciencester 便签，希望你能够在聚会上分发给用户。令人遗憾的是，你的便签打印机功能有限，每张便签上面最多只能打出五种色彩。</p><p class="calibre_">同时，由于负责美术的副总正在休假，因此，负责周边产品的副总向你咨询能否将其设计改为只包含五种颜色。</p><p class="calibre_">我们知道，计算机图像可以表示为像素的二维阵列，其中每个像素本身就是一个三维向量 <tt class="calibre7">(red, green, blue)</tt> ，代表了该像素的颜色（<a href="https://en.wikipedia.org/wiki/RGB_color_model" class="calibre3">https://en.wikipedia.org/wiki/RGB_color_model</a> ）。</p><p class="calibre_">为了得到图像的五色版本，我们需要执行下列步骤：</p><p class="calibre_">1. 选择五种颜色</p><p class="calibre_">2. 给每个像素从中挑选一种颜色</p><p class="calibre_">事实上，这个工作非常适合用 k-means 算法来做，因为该算法能够将像素划分为红 - 绿 - 蓝空间中的五个聚类。之后，我们只要将这些聚类中的像素用其中间色来重新着色就可以了。</p><p class="calibre_">首先，我们需要设法将图像加载到 Python 中。事实上，这可以借助 <tt class="calibre7">matplotlib</tt> 来实现：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>path_to_png_file = r"C:\images\image.png"   # 不管你的图像在哪里<br class="calibre12"/>import matplotlib.image as mpimg<br class="calibre12"/>img = mpimg.imread(path_to_png_file)<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">实际上，img 在幕后是作为一个 NumPy 数组来处理的，不过就这里来说，我们可以将其视为以列表为元素的列表所组成的列表。</p><p class="calibre_">这里，<tt class="calibre7">img[i][j]</tt> 表示第 <span class="italic">i</span> 行第 <span class="italic">j</span> 列的像素，并且每个像素都由一个取值范围介于 0 和 1 之 间的 <tt class="calibre7">[red, green, blue]</tt> 数字列表来指定其颜色：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>top_row = img[0]<br class="calibre12"/>top_left_pixel = top_row[0]<br class="calibre12"/>red, green, blue = top_left_pixel<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">特别是，我们可以将所有像素放到一个扁平化的列表中：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>pixels = [pixel for row in img for pixel in row]<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">然后将其送入我们的聚类模型：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>clusterer = KMeans(5)<br class="calibre12"/>clusterer.train(pixels)   # 这可能会花一些时间<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">一旦完成，我们得到了一张具有相同格式的新图像：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def recolor(pixel):<br class="calibre12"/>    cluster = clusterer.classify(pixel)         # 最近的聚类的索引<br class="calibre12"/>    return clusterer.means[cluster]             # 最近的聚类的均值<br class="calibre12"/><br class="calibre12"/>new_img = [[recolor(pixel) for pixel in row]    # 改变这一行像素的颜色<br class="calibre12"/>           for row in img] # 图像的每一行<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">接下来，我们就可以通过 <tt class="calibre7">plt.imshow()</tt> 来显示该图像了：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>plt.imshow(new_img)<br class="calibre12"/>plt.axis('off')<br class="calibre12"/>plt.show()<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">当然，在只有黑白色的书中无法展示这种色彩的效果，所以我们在图 19-5 中显示了一张全彩色图片的灰度图，以及一张采用这种技术将其降低到五种颜色后的灰度图：</p><p class="calibre_12"><img src="images/00082.jpg" class="calibre_143"/>
</p><p class="calibre_">
<span class="bold">图 19-5：原始图像以及利用 5-means 去色后的效果</span>
</p><div class="mbp_pagebreak" id="calibre_pb_137"></div>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre3">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre3">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
