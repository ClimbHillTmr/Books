<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>数据科学入门</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles1.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos463447" class="calibre_"><span class="calibre6"><span class="bold"> 15.3　拟合模型 </span></span></p><p class="calibre_">就像对简单线性模型所做的那样，我们这里也需要寻找一个能够最小化误差的平方和的 <tt class="calibre7">beta</tt> 。要想以手动方式找到一个精确的解可不是一件容易的事，因此，我们转而求助于梯度下降。下面我们首先创建一个待最小化的误差函数。对于随机梯度下降来说，我们只需要单次预测对应的平方误差：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def error(x_i, y_i, beta):<br class="calibre12"/>    return y_i - predict(x_i, beta)<br class="calibre12"/><br class="calibre12"/>def squared_error(x_i, y_i, beta):<br class="calibre12"/>    return error(x_i, y_i, beta) ** 2<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">如果你熟悉微积分，可以通过下面的方式进行计算：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def squared_error_gradient(x_i, y_i, beta):<br class="calibre12"/>    """the gradient (with respect to beta)<br class="calibre12"/>    corresponding to the ith squared error term"""<br class="calibre12"/>    return [-2 * x_ij * error(x_i, y_i, beta)<br class="calibre12"/>            for x_ij in x_i]<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">否则的话，就按照我说的来。</p><p class="calibre_">至此，我们就可以利用随机梯度下降法来寻找最优的 beta 了：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def estimate_beta(x, y):<br class="calibre12"/>    beta_initial = [random.random() for x_i in x[0]]<br class="calibre12"/>    return minimize_stochastic(squared_error,<br class="calibre12"/>                               squared_error_gradient,<br class="calibre12"/>                               x, y,<br class="calibre12"/>                               beta_initial,<br class="calibre12"/>                               0.001)<br class="calibre12"/><br class="calibre12"/>random.seed(0)<br class="calibre12"/>beta = estimate_beta(x, daily_minutes_good) # [30.63, 0.972, -1.868, 0.911]<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">这样的话，我们的模型就变成了：</p><p class="calibre_12"><img src="images/00156.jpg" class="calibre_115"/>
</p><div class="mbp_pagebreak" id="calibre_pb_104"></div>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre3">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre3">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
