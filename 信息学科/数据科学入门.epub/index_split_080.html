<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>数据科学入门</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles1.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos379434" class="calibre_"><span class="calibre6"><span class="bold"> 11.3　过拟合和欠拟合 </span></span></p><p class="calibre_">在机器学习中，一种常见的困境是<span class="bold">过拟合</span> （overfitting）——指一个在训练数据上表现良好，但对任何新数据的泛化能力却很差的模型。这可能牵扯到对数据中<span class="bold">噪声</span> 的学习，也可能涉及学习识别特别的输入，而不是对可以得到期望的输出进行准确预测的任何因素。</p><p class="calibre_">另一种有害的情况是<span class="bold">欠拟合</span> （underfitting），它产生的模型甚至在训练数据上都没有好的表现，尽管通常这暗示你模型不够好而要继续寻找改进的模型。</p><p class="calibre_12"><img src="images/00071.jpg" class="calibre_82"/>
</p><p class="calibre_">
<span class="bold">图 11-1：过拟合和欠拟合</span>
</p><p class="calibre_">在图 11-1 中，我对一组简单的数据拟合了 3 种多项式（别担心这是怎么做到的，我们会在后面的章节中介绍）。</p><p class="calibre_">水平线显示了最佳拟合阶数为 0（也就是常数）的多项式，它对训练数据来说存在严重的<span class="bold">欠拟合</span> 。最佳拟合的阶数为 9（也就是有 10 个参数）的多项式精确地穿过训练数据的每个点，但这是严重<span class="bold">过拟合</span> 的。如果我们能取到更多的一些点，这个多项式很有可能会偏离它们很多。阶数为 1 的线把握了很好的平衡——它和每个点都很接近，并且（如果这些数据是有代表性的）它也会和新的数据点很接近。</p><p class="calibre_">很明显，太复杂的模型会导致过拟合，并且在训练数据集之外不能很好地泛化。所以，我们该如何确保我们的模型不会太复杂呢？最基本的方法包括使用不同的数据来训练和测试模型。</p><p class="calibre_">最简单的做法是划分数据集，使得（比如说）三分之二的数据用来训练模型，之后用剩余的三分之一来衡量模型的表现：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def split_data(data, prob):<br class="calibre12"/>    """split data into fractions [prob, 1 - prob]"""<br class="calibre12"/>    results = [], []<br class="calibre12"/>    for row in data:<br class="calibre12"/>        results[0 if random.random() &lt; prob else 1].append(row)<br class="calibre12"/>    return results<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">通常我们会有一个作为输入变量的矩阵 <tt class="calibre7">x</tt> 和一个作为输出变量的向量 <tt class="calibre7">y</tt> 。这种情况下，我们要确保无论在训练数据还是测试数据中，都要把对应的值放在一起：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def train_test_split(x, y, test_pct):<br class="calibre12"/>    data = zip(x, y)                                    # 成对的对应值<br class="calibre12"/>    train, test = split_data(data, 1 - test_pct)        # 划分这个成对的数据集<br class="calibre12"/>    x_train, y_train = zip(*train)                      # 魔法般的解压技巧<br class="calibre12"/>    x_test, y_test = zip(*test)<br class="calibre12"/>    return x_train, x_test, y_train, y_test<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">这样你就可以做一些类似下面这样的处理：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>model = SomeKindOfModel()<br class="calibre12"/>x_train, x_test, y_train, y_test = train_test_split(xs, ys, 0.33)<br class="calibre12"/>model.train(x_train, y_train)<br class="calibre12"/>performance = model.test(x_test, y_test)<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">如果模型对训练数据是过拟合的，那么它在（完全划分开的）测试数据集上会有可能真的表现得很不好，换句话说，如果它在测试数据上表现良好，那么你可以肯定地说它<span class="bold">拟合良好</span> 而非<span class="bold">过拟合</span> 。</p><p class="calibre_">然而在有些情况下这也可能会出错。</p><p class="calibre_">第一种情况是训练和测试数据集中的共有模式不能泛化到大型数据集上。</p><p class="calibre_">比如，假设数据集包括用户活跃度，每位用户每周一列。在此情形下，大多数用户会出现在训练数据和测试数据中，而且有些模型可能会学习<span class="bold">识别</span> 用户而不是去发现涉及<span class="bold">属性</span> 的联系。这不是个太大的问题，尽管我曾经遇到过一次。</p><p class="calibre_">一个更大的问题是，如果你划分训练集和测试集的目的不仅仅是为了判断模型，也是为了在许多模型中进行<span class="bold">选择</span> 。此时，尽管不是所有的模型都是过拟合的，但“选择在测试集上表现最好的模型”是一种元训练（meta-training），会把测试集当作另一个训练集而运作。（当然，在测试集上有最好表现的模型会在测试集上有持续的好表现。）</p><p class="calibre_">在这种情况下，你应该把数据划分为三部分：一个用来建立模型的<span class="bold">训练</span> 集，一个为在训练好的模型上进行选择的<span class="bold">验证</span> 集，一个用来判断最终的模型的<span class="bold">测试</span> 集。</p><div class="mbp_pagebreak" id="calibre_pb_80"></div>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre3">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre3">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
