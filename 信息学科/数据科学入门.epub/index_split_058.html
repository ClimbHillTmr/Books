<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>数据科学入门</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles1.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos269016" class="calibre_"><span class="calibre6"><span class="bold"> 8.3　使用梯度 </span></span></p><p class="calibre_">很容易看出，当输入 <tt class="calibre7">v</tt> 是零向量时，函数 <tt class="calibre7">sum_of_squares</tt> 取值最小。但如果不知道输入是什么，可以用梯度方法从所有的三维向量中找到最小值。我们先找出随机初始点，并在梯度的反方向以小步逐步前进，直到梯度变得非常非常小：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def step(v, direction, step_size):<br class="calibre12"/>    """move step_size in the direction from v"""<br class="calibre12"/>    return [v_i + step_size * direction_i<br class="calibre12"/>            for v_i, direction_i in zip(v, direction)]<br class="calibre12"/><br class="calibre12"/>def sum_of_squares_gradient(v):<br class="calibre12"/>    return [2 * v_i for v_i in v]<br class="calibre12"/><br class="calibre12"/># 选取一个随机初始值<br class="calibre12"/>v = [random.randint(-10,10) for i in range(3)]<br class="calibre12"/><br class="calibre12"/>tolerance = 0.0000001<br class="calibre12"/><br class="calibre12"/>while True:<br class="calibre12"/>    gradient = sum_of_squares_gradient(v)   # 计算v的梯度<br class="calibre12"/>    next_v = step(v, gradient, -0.01)       # 取负的梯度步长<br class="calibre12"/>    if distance(next_v, v) &lt; tolerance:     # 如果收敛了就停止<br class="calibre12"/>        break<br class="calibre12"/>    v = next_v                              # 如果没汇合就继续<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">如果运行以上程序，你会发现，它总是止于一个非常接近 <tt class="calibre7">[0,0,0]</tt> 的 <tt class="calibre7">v</tt> 值。<tt class="calibre7">tolerance</tt> 值设定得越小，<tt class="calibre7">v</tt> 值就越接近 <tt class="calibre7">[0,0,0]</tt> 。</p><div class="mbp_pagebreak" id="calibre_pb_58"></div>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre3">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre3">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
