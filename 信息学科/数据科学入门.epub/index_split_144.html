<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>数据科学入门</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles1.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos617720" class="calibre_"><span class="calibre6"><span class="bold"> 20.4　题外话：吉布斯采样 </span></span></p><p class="calibre_">根据一些概率分布来生成样本是非常简单的事情。我们可以通过以下这行代码得到一些均匀分布的随机变量：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>random.random()<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">以及用以下代码得到一些正态分布的随机变量：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>inverse_normal_cdf(random.random())<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">但某些概率分布却很难进行采样。当我们只知道一些条件分布时，可以通过吉布斯采样技术根据多维分布来生成样本。</p><p class="calibre_">例如，假设我们在掷两只骰子。这里用 <span class="italic">x</span> 表示第一骰子的点数，<span class="italic">y</span> 表示两个骰子的点数之和。假设我们要产生大量形如 (x, y) 的数据对，这种情况下，我们可以直接通过下列代码来轻松生成所需样本：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def roll_a_die():<br class="calibre12"/>    return random.choice([1,2,3,4,5,6])<br class="calibre12"/><br class="calibre12"/>def direct_sample():<br class="calibre12"/>    d1 = roll_a_die()<br class="calibre12"/>    d2 = roll_a_die()<br class="calibre12"/>    return d1, d1 + d2<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">但是，这里假设你只知道条件分布。在已知道 <span class="italic">x</span> 的条件下求 <span class="italic">y</span> 的分布是很容易的：如果你知道了 <span class="italic">x</span> 的值，那么 <span class="italic">y</span> 就有同等机会等于 <span class="italic">x</span> +1，<span class="italic">x</span> +2，<span class="italic">x</span> +3，<span class="italic">x</span> +4，<span class="italic">x</span> +5，<span class="italic">x</span> +6：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def random_y_given_x(x):<br class="calibre12"/>    """equally likely to be x + 1, x + 2, ... , x + 6"""<br class="calibre12"/>    return x + roll_a_die()<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">如果将已知条件反过来，事情会变得更加复杂。举例来说，如果你知道 <span class="italic">y</span> 为 2，那么 <span class="italic">x</span> 必定为 1（因为只有当两个骰子的点数都为 1 的时候，点数之和才可能为 2）。如果你知道 <span class="italic">y</span> 为 3，那么 <span class="italic">x</span> 有等同的机会为 1 或 2。类似地，如果 <span class="italic">y</span> 为 11，那么 <span class="italic">x</span> 要么为 5，要么为 6：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def random_x_given_y(y):<br class="calibre12"/>    if y &lt;= 7:<br class="calibre12"/>        # 如果点数为7或以下的数，那么第一个骰子的点数有等同的机会为<br class="calibre12"/>        # 1, 2, …, (总点数 - 1)<br class="calibre12"/>        return random.randrange(1, y)<br class="calibre12"/>    else:<br class="calibre12"/>        # 如果点数为7或以上的数，那么第一个骰子的点数有等同的机会为<br class="calibre12"/>        # (total - 6), (总点数 - 5), …, 6<br class="calibre12"/>        return random.randrange(y - 6, 7)<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">吉布斯抽样的方法是先从任意（有效）的 <span class="italic">x</span> 和 <span class="italic">y</span> 值入手，然后不断用 <span class="italic">y</span> 条件下随机选择的 <span class="italic">x</span> 值替换原来的 <span class="italic">x</span> ，并用 <span class="italic">x</span> 条件下随机选择的 <span class="italic">y</span> 值替换原来的 <span class="italic">y</span> 。重复一定次数后，得到的 <span class="italic">x</span> 值和 <span class="italic">y</span> 值就可以作为根据无条件的联合分布获取的样本了：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def gibbs_sample(num_iters=100):<br class="calibre12"/>    x, y = 1, 2 # doesn't really matter<br class="calibre12"/>    for _ in range(num_iters):<br class="calibre12"/>        x = random_x_given_y(y)<br class="calibre12"/>        y = random_y_given_x(x)<br class="calibre12"/>    return x, y<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">通过下列代码你会发现，这种取样方法与直接取样的效果相似：</p><blockquote class="calibre_14"><span class="calibre11"><tt class="calibre7"><br class="calibre12"/>def compare_distributions(num_samples=1000):<br class="calibre12"/>    counts = defaultdict(lambda: [0, 0])<br class="calibre12"/>    for _ in range(num_samples):<br class="calibre12"/>        counts[gibbs_sample()][0] += 1<br class="calibre12"/>        counts[direct_sample()][1] += 1<br class="calibre12"/>    return counts<br class="calibre12"/><br class="calibre12"/><br class="calibre12"/><br class="calibre12"/></tt></span></blockquote><p class="calibre_15">我们将在接下来的部分使用这种取样方法。</p><div class="mbp_pagebreak" id="calibre_pb_144"></div>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre3">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre3">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
